<!-- Modalul pentru consimÈ›ÄƒmÃ¢nt rÄƒmÃ¢ne la Ã®nceput -->
<div *ngIf="showTermsModal" class="modal-overlay">
  <!-- ... conÈ›inutul modalului ... -->
</div>

<div class="dashboard-wrapper" [class.blurred]="showTermsModal">
  <div class="dashboard-container" *ngIf="user">
    <!-- Coloana din StÃ¢nga: Navigare È™i Profil -->
    <aside class="sidebar">
      <div class="profile-header">
        <div class="profile-avatar">{{ user.name.charAt(0) }}</div>
        <h2 class="profile-name">{{ user.name }}</h2>
        <p class="profile-email">{{ user.email }}</p>
      </div>
      <nav class="sidebar-nav">
        <button
          (click)="setActiveTab('donations')"
          [class.active]="activeTab === 'donations'"
        >
          Istoric DonaÈ›ii
        </button>
        <button
          (click)="setActiveTab('makeDonation')"
          [class.active]="activeTab === 'makeDonation'"
        >
          DoneazÄƒ Acum
        </button>
        <button
          (click)="setActiveTab('settings')"
          [class.active]="activeTab === 'settings'"
        >
          SetÄƒri Cont
        </button>
      </nav>
    </aside>

    <!-- Coloana din Dreapta: ConÈ›inutul Tab-ului Activ -->
    <main class="main-content">
      <!-- Mesaje de Feedback Generale -->
      <div *ngIf="message" class="message-box">{{ message }}</div>

      <!-- Tab-ul: Istoric DonaÈ›ii -->
      <div *ngIf="activeTab === 'donations'" class="content-panel">
        <h3>Istoricul DonaÈ›iilor Tale</h3>
        <p>
          Aici poÈ›i vedea toate actele tale de bunÄƒtate. ÃÈ›i mulÈ›umim din suflet
          pentru sprijin!
        </p>
        <div
          class="donations-list"
          *ngIf="donations.length > 0; else noDonations"
        >
          <table>
            <thead>
              <tr>
                <th>Data</th>
                <th>Suma</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let donation of donations">
                <td>{{ donation.date | date : "mediumDate" }}</td>
                <td>{{ donation.amount }} LEI</td>
              </tr>
            </tbody>
          </table>
        </div>
        <ng-template #noDonations>
          <div class="empty-state">Nu ai fÄƒcut nicio donaÈ›ie Ã®ncÄƒ. ğŸ’–</div>
        </ng-template>
      </div>

      <!-- Tab-ul: DoneazÄƒ Acum -->
      <div *ngIf="activeTab === 'makeDonation'" class="content-panel">
        <h3>FÄƒ o DonaÈ›ie</h3>
        <p>
          ContribuÈ›ia ta ne ajutÄƒ sÄƒ continuÄƒm misiunea. Alege metoda preferatÄƒ
          de a ajuta.
        </p>
        <div class="donation-forms-container">
          <!-- Formular DonaÈ›ie UnicÄƒ -->
          <form (ngSubmit)="submitDonation()" class="donation-form">
            <h4>DonaÈ›ie UnicÄƒ</h4>
            <label for="amount">SumÄƒ (LEI)</label>
            <input
              type="number"
              id="amount"
              name="amount"
              required
              [(ngModel)]="donationAmount"
              min="5"
            />
            <button type="submit">DoneazÄƒ o singurÄƒ datÄƒ</button>
          </form>
          <!-- Formular DonaÈ›ie LunarÄƒ -->
          <form (ngSubmit)="startSubscription()" class="donation-form">
            <h4>DonaÈ›ie LunarÄƒ</h4>
            <label for="subscriptionAmount">SumÄƒ (LEI)</label>
            <input
              type="number"
              id="subscriptionAmount"
              name="subscriptionAmount"
              required
              [(ngModel)]="subscriptionAmount"
              min="5"
            />
            <button type="submit">Devino Sponsor Lunar</button>
          </form>
        </div>
      </div>

      <!-- Tab-ul: SetÄƒri Cont -->
      <div *ngIf="activeTab === 'settings'" class="content-panel">
        <h3>SetÄƒrile Contului TÄƒu</h3>

        <!-- SecÈ›iune Gestionare Abonamente -->
        <div class="setting-section" *ngIf="hasSubscriptions">
          <h4>Abonamentele Mele</h4>
          <p>
            GestioneazÄƒ-È›i donaÈ›iile lunare È™i metodele de platÄƒ Ã®ntr-un portal
            securizat.
          </p>
          <button (click)="redirectToCustomerPortal()" class="portal-button">
            Mergi la Portalul de PlÄƒÈ›i
          </button>
        </div>

        <!-- SecÈ›iune Schimbare ParolÄƒ -->
        <div class="setting-section" *ngIf="user.hasLocalPassword">
          <h4>SchimbÄƒ Parola</h4>
          <form (ngSubmit)="changePassword()" class="password-form">
            <input
              type="password"
              name="currentPassword"
              placeholder="Parola curentÄƒ"
              required
              [(ngModel)]="changePasswordData.currentPassword"
            />
            <input
              type="password"
              name="newPassword"
              placeholder="Parola nouÄƒ"
              required
              [(ngModel)]="changePasswordData.newPassword"
            />
            <input
              type="password"
              name="confirmNewPassword"
              placeholder="ConfirmÄƒ parola nouÄƒ"
              required
              [(ngModel)]="changePasswordData.confirmNewPassword"
            />
            <button type="submit">ActualizeazÄƒ Parola</button>
          </form>
        </div>
      </div>
    </main>
  </div>
</div>
