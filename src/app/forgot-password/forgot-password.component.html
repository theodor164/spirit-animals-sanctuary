<div class="container">
  <div class="card">
    <h2>Forgot Password</h2>
    <p>
      Enter the email address associated with your account, and we'll send you a
      link to reset your password.
    </p>

    <form #forgotPasswordForm="ngForm">
      <div class="form-group">
        <label for="email">Email Address</label>
        <input
          type="email"
          id="email"
          name="email"
          [(ngModel)]="email"
          required
          email
          #emailInput="ngModel"
          [disabled]="isLoading"
        />
        <!-- Basic frontend validation message -->
        <div
          *ngIf="emailInput.invalid && (emailInput.dirty || emailInput.touched)"
          class="error-text"
        >
          Please enter a valid email address.
        </div>
      </div>
      <!-- reCAPTCHA Component -->
      <div class="form-group captcha-container">
        <ngx-invisible-recaptcha
          #captchaElem
          [siteKey]="recaptchaSiteKey"
          (success)="handleRecaptchaSuccess($event)"
        >
        </ngx-invisible-recaptcha>
      </div>

      <!-- Changed to a (click) event -->
      <button
        type="button"
        class="submit-btn"
        (click)="handleResetClick(forgotPasswordForm)"
        [disabled]="isLoading || forgotPasswordForm.invalid"
      >
        <span *ngIf="!isLoading">Send Reset Link</span>
        <span *ngIf="isLoading">Sending...</span>
      </button>
    </form>

    <!-- Display success or error messages from the backend -->
    <div
      *ngIf="message"
      class="message-box"
      [class.error]="isError"
      [class.success]="!isError"
    >
      {{ message }}
    </div>

    <div class="form-footer">
      <a routerLink="/login">Back to Login</a>
    </div>
  </div>
</div>
